import{r as c,p as D,C as q,a as F,o,c as a,b as t,t as s,e as v,d as g,n as I,F as C,f as P,u as h,l as j,x as E,y as R,_ as z,g as W,w as X}from"./index-wONQE6OV.js";import{V as G}from"./index-ENWe5MEy.js";import{u as m}from"./usePriceToTw-mhH8eMrj.js";import{M as H}from"./bootstrap.esm-FzNOyMo5.js";import{_ as J}from"./PaginationComponent-m2HiFVTu.js";const Q={class:"modal-dialog modal-lg"},Y={class:"modal-content border-0"},Z={class:"modal-header bg-dark text-white"},tt={id:"frontMemberModalLabel",class:"modal-title"},et={class:"modal-body position-relative"},st={key:0},ot={class:"row"},at={class:"col-12"},lt={class:"table-responsive border border-2 border-dark px-3 mb-3 pt-3"},nt={class:"fs-5 border-bottom border-dark pb-2 mb-3"},dt={class:"table align-middle"},ct=t("td",null,"姓名",-1),it=t("td",null,"連絡電話",-1),rt=t("td",null,"連絡信箱",-1),ut=t("td",null,"訂購地址",-1),_t=t("td",null,"訂單備註",-1),pt=t("td",null,"訂單當前狀態",-1),ht={key:1,class:"text-muted"},vt=t("td",null,"訂單付款狀態",-1),bt={key:0,class:"text-success"},mt={key:1,class:"text-danger"},ft={class:"col-12"},xt={class:"table-responsive border-top border-start border-end border-2 border-dark px-3 pt-3"},yt={class:"fs-5 border-bottom border-dark pb-2 mb-3"},kt={class:"table align-middle"},gt=t("thead",null,[t("tr",null,[t("td",null,"品項名稱"),t("td",null,"單價(NT)"),t("td",null,"數量"),t("td",null,"小計(NT)")])],-1),$t={key:0},wt={class:"row"},Mt={class:"col-lg-12"},Ct={class:"text-muted text-decoration-line-through"},Tt={class:"text-danger ps-2"},Ot={key:1},Nt={class:"border-start border-end border-2 border-dark mb-3"},Bt={class:"d-flex justify-content-end border-bottom border-2 border-dark pb-12 mb-12 pe-3"},St={class:"d-flex flex-column align-items-end"},Vt={class:"fs-5"},Lt={class:"fw-700"},At={key:0,class:"text-danger"},Dt=t("span",{class:"text-muted"},"*已含運費",-1),Ft={key:1,class:"text-center py-64"},It={__name:"MemberOrderModal",setup(U,{expose:$}){const{showAlert:w}=R(),u=c(""),e=c({}),b=c(!0),r=c([]),f=c(null),_=c(null);D(()=>{_.value=new H(f.value)}),q(()=>{_.value&&_.value.dispose()});const M=async n=>{try{b.value=!0;const i=`https://vue3-course-api.hexschool.io/v2/api/vue-ben0588/order/${n}`,d=await E.get(i);e.value=d.data.order,r.value=Object.values(d.data.order.products||{})}catch(i){w({title:"失敗",text:`${i.response.data.message}`,icon:"error",confirmButtonText:"確認",confirmButtonColor:"#000000",allowEscapeKey:!1,allowOutsideClick:!1})}finally{b.value=!1}},x=n=>{u.value=n,M(n),_.value.show()},y=()=>{_.value.hide()};return $({openModal:x,closeModal:y}),(n,i)=>{var l,k,T,O,N,B,S,V,L,A;const d=F("font-awesome-icon");return o(),a("div",{class:"modal fade",tabindex:"-1","aria-labelledby":"frontMemberModalLabel","aria-hidden":"true",ref_key:"bsFrontMemberModalRef",ref:f},[t("div",Q,[t("div",Y,[t("div",Z,[t("h5",tt,"查看訂單：編碼"+s(u.value),1),t("button",{type:"button",class:"bg-dark text-white fs-4 fw-bolder border-0","data-bs-dismiss":"modal","aria-label":"Close",onClick:y}," X ")]),t("div",et,[b.value?(o(),a("div",Ft,"讀取中，請稍後..")):(o(),a("div",st,[t("div",ot,[t("div",at,[t("div",lt,[t("p",nt,[v(d,{icon:["far","address-card"]}),g(" 訂購人資料 ")]),t("table",dt,[t("tbody",null,[t("tr",null,[ct,t("td",null,s((k=(l=e.value)==null?void 0:l.user)==null?void 0:k.name),1)]),t("tr",null,[it,t("td",null,s((O=(T=e.value)==null?void 0:T.user)==null?void 0:O.tel),1)]),t("tr",null,[rt,t("td",null,s((B=(N=e.value)==null?void 0:N.user)==null?void 0:B.email),1)]),t("tr",null,[ut,t("td",null,s((V=(S=e.value)==null?void 0:S.user)==null?void 0:V.address),1)]),t("tr",null,[_t,t("td",null,s(e.value.message),1)]),t("tr",null,[pt,t("td",null,[e.value.status?(o(),a("span",{key:0,class:I(`${e.value.status=="0"?"text-muted":e.value.status=="1"?"text-dark":e.value.status=="2"?"text-info":"text-success"}`)},s(e.value.status=="0"?"未確認":e.value.status=="1"?"已確認":e.value.status=="2"?"寄送中":"已送達"),3)):(o(),a("span",ht,"未確認"))])]),t("tr",null,[vt,t("td",null,[e.value.is_paid&&e.value.paid_date?(o(),a("span",bt,"已付款 ("+s(new Date(e.value.paid_date*1e3).toISOString().split("T")[0])+")",1)):(o(),a("span",mt,"未付款"))])])])])])]),t("div",ft,[t("div",xt,[t("p",yt,[v(d,{icon:["fas","receipt"]}),g(" 訂單詳情 ")]),t("table",kt,[gt,t("tbody",null,[(o(!0),a(C,null,P(e.value.products,(p,K)=>(o(),a("tr",{key:K},[t("td",null,s(p.product.title),1),t("td",null,s(h(m)(p.product.price)),1),t("td",null,s(p.qty),1),p.coupon?(o(),a("td",$t,[t("div",wt,[t("div",Mt,[t("span",Ct,s(h(m)(p.total)),1),t("span",Tt,s(h(m)(p.final_total)),1)])])])):(o(),a("td",Ot,s(h(m)(p.final_total)),1))]))),128))])])]),t("div",Nt,[t("div",Bt,[t("div",St,[t("span",Vt,[t("span",null," 共 "+s(r.value.length)+" 項商品 | ",1),t("span",Lt," 合計 NT"+s(h(m)(e.value.total)),1)]),(A=(L=r.value[0])==null?void 0:L.coupon)!=null&&A.title?(o(),a("span",At,[v(d,{icon:["fas","ticket-simple"]}),g(" 已套用優惠碼："+s(r.value[0].coupon.title)+"："+s(r.value[0].coupon.code),1)])):j("",!0),Dt])])])])])]))])])])],512)}}},Pt={key:0,class:"container"},jt={key:0},Et={class:"table-responsive mb-3"},Rt={class:"table align-middle"},Ut=t("thead",null,[t("tr",null,[t("td",null,"訂單建立日期"),t("td",null,"訂單金額(NT)"),t("td",null,"付款狀態"),t("td",null,"寄送狀態"),t("td",null,"更多操作")])],-1),Kt={key:0,class:"flex-center flex-column align-items-start text-success"},qt=t("span",null,"已付款",-1),zt={key:1,class:"text-dark"},Wt={key:1,class:"text-muted"},Xt={colspan:"2",style:{minWidth:"200px"}},Gt={class:"d-flex"},Ht=["onClick"],Jt=["to","disabled","onClick"],Qt={key:1,class:"row justify-content-start py-32"},Yt={class:"col-xl-6"},Zt=t("p",{class:"d-flex align-items-center fs-4 text-start mb-4"}," 您還尚未訂立訂單，立即前往逛逛商品~ ",-1),te=t("div",{class:"col-xl-6"},null,-1),ne={__name:"MemberOrdersView",setup(U){const $=z(),{showAlert:w}=R(),u=c(!1),e=c([]),b=c([]),r=c(null),f="https://vue3-course-api.hexschool.io",_="vue-ben0588",M=n=>{$.push({name:"front_order_payment",params:{id:n}})},x=async(n=1)=>{try{u.value=!0;const i=`${f}/v2/api/${_}/orders?page=${n}`,d=await E.get(i);e.value=d.data.orders,b.value=d.data.pagination}catch(i){w({title:"失敗",text:`${i.response.data.message}`,icon:"error",confirmButtonText:"確認",confirmButtonColor:"#000000",allowEscapeKey:!1,allowOutsideClick:!1})}finally{u.value=!1}};D(()=>{x()});const y=n=>{r.value.openModal(n)};return(n,i)=>{const d=F("router-link");return o(),a(C,null,[u.value?j("",!0):(o(),a("div",Pt,[e.value.length?(o(),a("div",jt,[t("div",Et,[t("table",Rt,[Ut,t("tbody",null,[(o(!0),a(C,null,P(e.value,l=>(o(),a("tr",{key:l.id},[t("td",null,s(new Date(l.create_at*1e3).toLocaleString()),1),t("td",null,s(h(m)(l.total)),1),t("td",null,[l.is_paid&&l.paid_date?(o(),a("div",Kt,[qt,t("span",null,s(new Date(l.paid_date*1e3).toISOString().split("T")[0]),1)])):(o(),a("span",zt,"未付款"))]),t("td",null,[l.status?(o(),a("span",{key:0,class:I(`${l.status==0?"text-muted":l.status==1?"text-dark":l.status==2?"text-info":"text-success"}`)},s(l.status==0?"未確認":l.status==1?"已確認":l.status==2?"寄送中":"已送達"),3)):(o(),a("span",Wt,"未確認"))]),t("td",Xt,[t("div",Gt,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:k=>y(l.id)}," 查看詳情 ",8,Ht),t("button",{type:"button",to:`/carts/payment/${l.id}`,class:"btn btn-primary text-white ms-1",disabled:l.is_paid,onClick:X(k=>M(l.id),["prevent"])}," 前往付款 ",8,Jt)])])]))),128))])])]),v(J,{pagination:b.value,"onUpdated:page":x},null,8,["pagination"])])):(o(),a("div",Qt,[t("div",Yt,[Zt,v(d,{to:"/products",class:"btn btn-dark px-4 ms-2"},{default:W(()=>[g("去逛逛")]),_:1})]),te]))])),v(h(G),{active:u.value,"can-cancel":!1,color:"#0089A7"},null,8,["active"]),v(It,{ref_key:"orderModal",ref:r},null,512)],64)}}};export{ne as default};
