import{r as c,p as P,C as q,a as S,o as e,c as s,b as t,t as o,e as b,d as g,n as D,F as C,f as I,u as h,l as j,x as E,y as R,Z as z,g as W,w as X}from"./index-Pqrum06f.js";import{V as Z}from"./index-DnuBronG.js";import{u as v}from"./usePriceToTw-mhH8eMrj.js";import{M as G}from"./bootstrap.esm-FzNOyMo5.js";import{_ as H}from"./PaginationComponent-LaWhB1Sw.js";const J={class:"modal-dialog modal-lg"},Q={class:"modal-content border-0"},Y={class:"modal-header bg-dark text-white"},tt={id:"frontMemberModalLabel",class:"modal-title"},et={class:"modal-body position-relative"},st={key:0},ot={class:"row"},at={class:"col-12"},lt={class:"table-responsive border border-2 border-dark px-3 mb-3 pt-3"},nt={class:"fs-5 border-bottom border-dark pb-2 mb-3"},dt={class:"table align-middle"},ct=t("td",null,"姓名",-1),rt=t("td",null,"連絡電話",-1),it=t("td",null,"連絡信箱",-1),ut=t("td",null,"訂購地址",-1),_t=t("td",null,"訂單備註",-1),pt=t("td",null,"訂單當前狀態",-1),ht={key:1,class:"text-muted"},bt=t("td",null,"訂單付款狀態",-1),mt={key:0,class:"text-success"},vt={key:1,class:"text-danger"},ft={class:"col-12"},xt={class:"table-responsive border-top border-start border-end border-2 border-dark px-3 pt-3"},yt={class:"fs-5 border-bottom border-dark pb-2 mb-3"},kt={class:"table align-middle"},gt=t("thead",null,[t("tr",null,[t("td",null,"品項名稱"),t("td",null,"單價(NT)"),t("td",null,"數量"),t("td",null,"小計(NT)")])],-1),$t={key:0},wt={class:"row"},Mt={class:"col-lg-12"},Ct={class:"text-muted text-decoration-line-through"},Tt={class:"text-danger ps-2"},Ot={key:1},Nt={class:"border-start border-end border-2 border-dark mb-3"},Bt={class:"d-flex justify-content-end border-bottom border-2 border-dark pb-12 mb-12 pe-3"},Vt={class:"d-flex flex-column align-items-end"},Lt={class:"fs-5"},At={class:"fw-700"},Ft={key:0,class:"text-danger"},Pt=t("span",{class:"text-muted"},"*已含運費",-1),St={key:1,class:"text-center py-64"},Dt={__name:"MemberOrderModal",setup(U,{expose:$}){const{showAlert:w}=R(),u=c(""),a=c({}),m=c(!0),i=c([]),f=c(null),_=c(null);P(()=>{_.value=new G(f.value)}),q(()=>{_.value&&_.value.dispose()});const M=async n=>{try{m.value=!0;const r=`https://vue3-course-api.hexschool.io/v2/api/vue-ben0588/order/${n}`,d=await E.get(r);a.value=d.data.order,i.value=Object.values(d.data.order.products||{})}catch(r){w({title:"失敗",text:`${r.response.data.message}`,icon:"error",confirmButtonText:"確認",confirmButtonColor:"#000000",allowEscapeKey:!1,allowOutsideClick:!1})}finally{m.value=!1}},x=n=>{u.value=n,M(n),_.value.show()},y=()=>{_.value.hide()};return $({openModal:x,closeModal:y}),(n,r)=>{var l,k,T,O,N,B,V,L,A,F;const d=S("font-awesome-icon");return e(),s("div",{class:"modal fade",tabindex:"-1","aria-labelledby":"frontMemberModalLabel","aria-hidden":"true",ref_key:"bsFrontMemberModalRef",ref:f},[t("div",J,[t("div",Q,[t("div",Y,[t("h5",tt,"查看訂單：編碼"+o(u.value),1),t("button",{type:"button",class:"bg-dark text-white fs-4 fw-bolder border-0","data-bs-dismiss":"modal","aria-label":"Close",onClick:y}," X ")]),t("div",et,[m.value?(e(),s("div",St,"讀取中，請稍後..")):(e(),s("div",st,[t("div",ot,[t("div",at,[t("div",lt,[t("p",nt,[b(d,{icon:["far","address-card"]}),g(" 訂購人資料 ")]),t("table",dt,[t("tbody",null,[t("tr",null,[ct,t("td",null,o((k=(l=a.value)==null?void 0:l.user)==null?void 0:k.name),1)]),t("tr",null,[rt,t("td",null,o((O=(T=a.value)==null?void 0:T.user)==null?void 0:O.tel),1)]),t("tr",null,[it,t("td",null,o((B=(N=a.value)==null?void 0:N.user)==null?void 0:B.email),1)]),t("tr",null,[ut,t("td",null,o((L=(V=a.value)==null?void 0:V.user)==null?void 0:L.address),1)]),t("tr",null,[_t,t("td",null,o(a.value.message),1)]),t("tr",null,[pt,t("td",null,[a.value.status?(e(),s("span",{key:0,class:D(`${a.value.status===0?"text-muted":a.value.status===1?"text-dark":a.value.status===2?"text-info":"text-success"}`)},o(a.value.status===0?"未確認":a.value.status===1?"已確認":a.value.status===2?"寄送中":"已送達"),3)):(e(),s("span",ht,"未確認"))])]),t("tr",null,[bt,t("td",null,[a.value.is_paid?(e(),s("span",mt,"已付款")):(e(),s("span",vt,"未付款"))])])])])])]),t("div",ft,[t("div",xt,[t("p",yt,[b(d,{icon:["fas","receipt"]}),g(" 訂單詳情 ")]),t("table",kt,[gt,t("tbody",null,[(e(!0),s(C,null,I(a.value.products,(p,K)=>(e(),s("tr",{key:K},[t("td",null,o(p.product.title),1),t("td",null,o(h(v)(p.product.price)),1),t("td",null,o(p.qty),1),p.coupon?(e(),s("td",$t,[t("div",wt,[t("div",Mt,[t("span",Ct,o(h(v)(p.total)),1),t("span",Tt,o(h(v)(p.final_total)),1)])])])):(e(),s("td",Ot,o(h(v)(p.final_total)),1))]))),128))])])]),t("div",Nt,[t("div",Bt,[t("div",Vt,[t("span",Lt,[t("span",null," 共 "+o(i.value.length)+" 項商品 | ",1),t("span",At," 合計 NT"+o(h(v)(a.value.total)),1)]),(F=(A=i.value[0])==null?void 0:A.coupon)!=null&&F.title?(e(),s("span",Ft,[b(d,{icon:["fas","ticket-simple"]}),g(" 已套用優惠碼："+o(i.value[0].coupon.title)+"："+o(i.value[0].coupon.code),1)])):j("",!0),Pt])])])])])]))])])])],512)}}},It={key:0,class:"container"},jt={key:0},Et={class:"table-responsive mb-3"},Rt={class:"table align-middle"},Ut=t("thead",null,[t("tr",null,[t("td",null,"訂單建立日期"),t("td",null,"訂單金額(NT)"),t("td",null,"付款狀態"),t("td",null,"寄送狀態"),t("td",null,"更多操作")])],-1),Kt={key:0,class:"flex-center flex-column align-items-start text-success"},qt=t("span",null,"已付款",-1),zt={key:1,class:"text-dark"},Wt={key:1,class:"text-muted"},Xt={colspan:"2",style:{minWidth:"200px"}},Zt={class:"d-flex"},Gt=["onClick"],Ht=["to","disabled","onClick"],Jt={key:1,class:"row justify-content-start py-32"},Qt={class:"col-xl-6"},Yt=t("p",{class:"d-flex align-items-center fs-4 text-start mb-4"}," 您還尚未訂立訂單，立即前往逛逛商品~ ",-1),te=t("div",{class:"col-xl-6"},null,-1),ne={__name:"MemberOrdersView",setup(U){const $=z(),{showAlert:w}=R(),u=c(!1),a=c([]),m=c([]),i=c(null),f="https://vue3-course-api.hexschool.io",_="vue-ben0588",M=n=>{$.push({name:"front_order_payment",params:{id:n}})},x=async(n=1)=>{try{u.value=!0;const r=`${f}/v2/api/${_}/orders?page=${n}`,d=await E.get(r);a.value=d.data.orders,m.value=d.data.pagination}catch(r){w({title:"失敗",text:`${r.response.data.message}`,icon:"error",confirmButtonText:"確認",confirmButtonColor:"#000000",allowEscapeKey:!1,allowOutsideClick:!1})}finally{u.value=!1}};P(()=>{x()});const y=n=>{i.value.openModal(n)};return(n,r)=>{const d=S("router-link");return e(),s(C,null,[u.value?j("",!0):(e(),s("div",It,[a.value.length?(e(),s("div",jt,[t("div",Et,[t("table",Rt,[Ut,t("tbody",null,[(e(!0),s(C,null,I(a.value,l=>(e(),s("tr",{key:l.id},[t("td",null,o(new Date(l.create_at*1e3).toLocaleString()),1),t("td",null,o(h(v)(l.total)),1),t("td",null,[l.is_paid?(e(),s("div",Kt,[qt,t("span",null,o(new Date(l.paid_date*1e3).toISOString().split("T")[0]),1)])):(e(),s("span",zt,"未付款"))]),t("td",null,[l.status?(e(),s("span",{key:0,class:D(`${l.status===0?"text-muted":l.status===1?"text-dark":l.status===2?"text-info":"text-success"}`)},o(l.status===0?"未確認":l.status===1?"已確認":l.status===2?"寄送中":"已送達"),3)):(e(),s("span",Wt,"未確認"))]),t("td",Xt,[t("div",Zt,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:k=>y(l.id)}," 查看詳情 ",8,Gt),t("button",{type:"button",to:`/carts/payment/${l.id}`,class:"btn btn-primary text-white ms-1",disabled:l.is_paid,onClick:X(k=>M(l.id),["prevent"])}," 前往付款 ",8,Ht)])])]))),128))])])]),b(H,{pagination:m.value,"onUpdated:page":x},null,8,["pagination"])])):(e(),s("div",Jt,[t("div",Qt,[Yt,b(d,{to:"/products",class:"btn btn-dark px-4 ms-2"},{default:W(()=>[g("去逛逛")]),_:1})]),te]))])),b(h(Z),{active:u.value,"can-cancel":!1,color:"#0089A7"},null,8,["active"]),b(Dt,{ref_key:"orderModal",ref:i},null,512)],64)}}};export{ne as default};
