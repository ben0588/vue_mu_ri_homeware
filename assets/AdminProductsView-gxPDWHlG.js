import{r as y,ac as te,q as K,x as E,p as G,C as ae,j as ne,o as c,c as r,b as e,t as l,u as t,F as S,f as C,n as X,w as le,d as v,h as m,v as f,l as U,y as Q,s as de,bS as j,z as P,A as oe,Z as ie,e as Z,a2 as ce,a as re}from"./index-OZ5cqwnL.js";import{u as _e}from"./loadingStores-MaNKI3gX.js";import{u as ee}from"./usePriceToTw-mhH8eMrj.js";import{M as ue}from"./bootstrap.esm-FzNOyMo5.js";import{u as se}from"./i18nStores-EnOHUesi.js";import{_ as me}from"./PaginationComponent-Bgjm-W3Y.js";const pe={class:"modal-dialog modal-xl"},ge={class:"modal-content border-0"},he={class:"modal-header bg-dark text-white"},ve={id:"productModalLabel",class:"modal-title"},be=["title"],fe={class:"mt-2"},ye={class:"nav nav-tabs"},xe=["onClick"],we={class:"modal-body"},ke=e("span",{class:"text-danger"},"*",-1),$e=e("hr",null,null,-1),Ie={class:"row"},Ue={class:"col-sm-4"},Oe={class:"mb-3"},Se={for:"imageUrl",class:"form-label"},Ce=e("span",{class:"text-danger"},"*",-1),Ne=["placeholder"],Ve={class:"input-group mb-3"},Be={for:"imageUrlFile",class:"form-label w-100"},Te=["value","disabled","title"],Me={class:"input-group mb-3"},Le={class:"form-label w-100"},Je=["onUpdate:modelValue","placeholder"],De={class:"input-group mb-3"},Re=e("label",{class:"form-label w-100"},"輸入圖片描述 (共五張)",-1),Pe=["onUpdate:modelValue","placeholder"],Ae={key:0},He={class:"mb-0 mt-2 fw-bolder"},je=["src"],ze={key:0},Fe={class:"mb-0 mt-2"},qe=["src"],Ee={class:"col-sm-8"},Ke={class:"mb-3"},We={for:"title",class:"form-label"},Xe=e("span",{class:"text-danger"},"*",-1),Ze=["placeholder"],Ge={class:"row"},Qe={class:"mb-3 col-md-6"},Ye={for:"category",class:"form-label"},et=e("span",{class:"text-danger"},"*",-1),tt={value:"",selected:"",disabled:""},ot=["value"],st={class:"mb-3 col-md-6"},at={for:"subcategory",class:"form-label"},nt=e("span",{class:"text-danger"},"*",-1),lt={key:0,value:"",selected:"",disabled:""},dt=["value"],it={class:"mb-3 col-md-6"},ct={for:"unit",class:"form-label"},rt=e("span",{class:"text-danger"},"*",-1),_t=["placeholder"],ut={class:"mb-3 col-md-6"},mt={for:"stock",class:"form-label"},pt=e("span",{class:"text-danger"},"*",-1),gt=["placeholder"],ht={class:"row"},vt={class:"mb-3 col-md-6"},bt={for:"origin_price",class:"form-label"},ft=e("span",{class:"text-danger"},"*",-1),yt=["placeholder"],xt={class:"mb-3 col-md-6"},wt={for:"price",class:"form-label"},kt=e("span",{class:"text-danger"},"*",-1),$t=["placeholder"],It={class:"mb-3 col-md-6 mt-4"},Ut={for:"dimensions",class:"form-label"},Ot=e("span",{class:"text-danger"},"*",-1),St=["placeholder"],Ct=["placeholder"],Nt=["placeholder"],Vt={class:"mb-3 col-md-6"},Bt={for:"colors",class:"form-label"},Tt=e("span",{class:"text-danger"},"*",-1),Mt=e("br",null,null,-1),Lt=e("span",{class:"text-danger"},"*",-1),Jt=["placeholder","onUpdate:modelValue"],Dt=["placeholder","onUpdate:modelValue"],Rt={class:"row"},Pt={class:"col-md-6 mb-3"},At={for:"material",class:"form-label"},Ht=e("span",{class:"text-danger"},"*",-1),jt=["placeholder"],zt={class:"col-md-6 mb-3 mt-2"},Ft={class:"form-label"},qt=e("span",{class:"text-danger"},"*",-1),Et=["for"],Kt=["id","onUpdate:modelValue"],Wt={class:"my-3"},Xt={for:"description",class:"form-label"},Zt=e("span",{class:"text-danger"},"*",-1),Gt=["placeholder"],Qt={class:"mb-3"},Yt={for:"content",class:"form-label"},eo=e("span",{class:"text-danger"},"*",-1),to=["placeholder"],oo={class:"mb-3"},so={class:"fw-bolder fs-6"},ao=e("span",{class:"text-danger"},"*",-1),no={class:"form-check d-inline-block"},lo={class:"form-check-label",for:"isNew"},io=["checked"],co={class:"form-check d-inline-block ms-4"},ro={class:"form-check-label",for:"isOnHot"},_o=["checked"],uo={class:"form-check d-inline-block ms-4"},mo={class:"form-check-label",for:"isRecommended"},po=["checked"],go={class:"form-check d-inline-block ms-4"},ho={class:"form-check-label",for:"isOnSale"},vo=["checked"],bo=e("hr",null,null,-1),fo={class:"mb-3"},yo={class:"fw-bolder fs-6"},xo=e("span",{class:"text-danger"},"*",-1),wo={class:"form-check"},ko={class:"form-check-label",for:"is_enabled"},$o={class:"modal-footer"},Io=["disabled"],Uo={key:0},Oo=e("span",{class:"spinner-border spinner-border-sm me-2","aria-hidden":"true"},null,-1),So=e("span",{role:"status"},null,-1),Co=[Oo,So],No={__name:"AdminProductsModal",props:{typeName:String},emits:["refetch-products"],setup(Y,{expose:z,emit:k}){const i="https://vue3-course-api.hexschool.io",N="vue-ben0588",F=y(null),V=y(null),a=se(),{t:s}=te(),{showAlert:B}=oe(),M=Y,R=k,h={id:new Date().getTime(),title:"",category:"",subcategory:"",unit:"",stock:"",imageUrl:"",imagesUrl:["","","","",""],imagesUrlDescriptions:["","","","",""],price:"",origin_price:"",description:"",content:"",is_enabled:1,ratings:{star_1:{count:0,reviews:[{user:"評論名稱",comment:"產品描述",reviewId:"頻論會員id"}]},star_2:{count:0},star_3:{count:0},star_4:{count:0},star_5:{count:9,reviews:[{user:"Alex",comment:"商品品質再棒了!很喜歡",reviewId:"r1"},{user:"Ben",comment:"躺起來非常舒服~~",reviewId:"r2"}]}},create_date:Math.floor(new Date().getTime()/1e3),sales_num:0,isNew:!0,isOnHot:!1,isRecommended:!1,isOnSale:!1,material:"",dimensions:{length:"",width:"",height:""},colors:[{title:"",code:""},{title:"",code:""},{title:"",code:""}]},o=y({title:"title",category:"category",origin_price:999,price:999,unit:"unit",description:"description",content:"content",is_enabled:1,imageUrl:"主圖網址",imagesUrl:["1","2","3","4","5"],ratings:{star_1:{count:0,reviews:[{user:"評論名稱",comment:"產品描述",reviewId:"頻論會員id"}]},star_2:{count:0},star_3:{count:0},star_4:{count:0},star_5:{count:9,reviews:[{user:"Alex",comment:"商品品質再棒了!很喜歡",reviewId:"r1"},{user:"Ben",comment:"躺起來非常舒服~~",reviewId:"r2"}]}},create_date:Math.floor(new Date().getTime()/1e3),sales_num:0,isNew:!0,isOnHot:!1,isRecommended:!1,isOnSale:!1,material:"",dimensions:{length:"",width:"",height:""},colors:[{title:"",code:""},{title:"",code:""},{title:"",code:""}],tw:{...h},us:{...h},jp:{...h},kr:{...h},th:{...h}}),A=K(()=>[{id:"1",text:s("admin.products_modal_category_furniture")},{id:"2",text:s("admin.products_modal_category_home_decor")},{id:"3",text:s("admin.products_modal_category_lighting")},{id:"4",text:s("admin.products_modal_category_kitchenware")},{id:"5",text:s("admin.products_modal_category_bathroom_accessories")},{id:"6",text:s("admin.products_modal_category_bedding")},{id:"7",text:s("admin.products_modal_category_storage")},{id:"8",text:s("admin.products_modal_category_outdoor_and_garden")},{id:"9",text:s("admin.products_modal_category_office_supplies")},{id:"10",text:s("admin.products_modal_category_children_furniture")}]),H=K(()=>[{id:"1",text:s("admin.products_modal_subcategory_sofas_and_chairs"),cid:"1"},{id:"2",text:s("admin.products_modal_subcategory_tables_and_chairs"),cid:"1"},{id:"3",text:s("admin.products_modal_subcategory_desks_and_office_chairs"),cid:"1"},{id:"4",text:s("admin.products_modal_subcategory_bed_frames_and_mattresses"),cid:"1"},{id:"5",text:s("admin.products_modal_subcategory_wardrobes_and_storage_cabinets"),cid:"1"},{id:"6",text:s("admin.products_modal_subcategory_coffee_tables_and_side_tables"),cid:"1"},{id:"7",text:s("admin.products_modal_subcategory_outdoor_furniture"),cid:"1"},{id:"9",text:s("admin.products_modal_subcategory_rugs_and_floor_mats"),cid:"2"},{id:"10",text:s("admin.products_modal_subcategory_curtains_and_blinds"),cid:"2"},{id:"11",text:s("admin.products_modal_subcategory_paintings_and_wall_decor"),cid:"2"},{id:"12",text:s("admin.products_modal_subcategory_decorative_pillows_and_throw_pillows"),cid:"2"},{id:"13",text:s("admin.products_modal_subcategory_mirrors"),cid:"2"},{id:"14",text:s("admin.products_modal_subcategory_vases_and_indoor_plants"),cid:"2"},{id:"15",text:s("admin.products_modal_subcategory_candles_and_fragrances"),cid:"2"},{id:"16",text:s("admin.products_modal_subcategory_pendant_lights"),cid:"3"},{id:"17",text:s("admin.products_modal_subcategory_floor_lamps"),cid:"3"},{id:"18",text:s("admin.products_modal_subcategory_table_lamps"),cid:"3"},{id:"19",text:s("admin.products_modal_subcategory_wall_lamps"),cid:"3"},{id:"20",text:s("admin.products_modal_subcategory_outdoor_lighting"),cid:"3"},{id:"21",text:s("admin.products_modal_subcategory_lighting_accessories"),cid:"3"},{id:"22",text:s("admin.products_modal_subcategory_cookware_and_cooking_utensils"),cid:"4"},{id:"23",text:s("admin.products_modal_subcategory_tableware_and_dining_sets"),cid:"4"},{id:"24",text:s("admin.products_modal_subcategory_kitchen_storage_and_organization"),cid:"4"},{id:"25",text:s("admin.products_modal_subcategory_small_kitchen_appliances"),cid:"4"},{id:"26",text:s("admin.products_modal_subcategory_knives_and_cutting_boards"),cid:"4"},{id:"27",text:s("admin.products_modal_subcategory_bath_towels_and_bathroom_mats"),cid:"5"},{id:"28",text:s("admin.products_modal_subcategory_bathroom_storage"),cid:"5"},{id:"29",text:s("admin.products_modal_subcategory_bathroom_accessories"),cid:"5"},{id:"30",text:s("admin.products_modal_subcategory_bathroom_decor"),cid:"5"},{id:"31",text:s("admin.products_modal_subcategory_sheets_and_bed_covers"),cid:"6"},{id:"32",text:s("admin.products_modal_subcategory_blankets_and_quilts"),cid:"6"},{id:"33",text:s("admin.products_modal_subcategory_pillows_and_pillowcases"),cid:"6"},{id:"34",text:s("admin.products_modal_subcategory_mattress_protectors"),cid:"6"},{id:"35",text:s("admin.products_modal_subcategory_bookshelves_and_display_cabinets"),cid:"7"},{id:"36",text:s("admin.products_modal_subcategory_storage_boxes_and_baskets"),cid:"7"},{id:"37",text:s("admin.products_modal_subcategory_closet_organizers"),cid:"7"},{id:"38",text:s("admin.products_modal_subcategory_shoe_racks_and_coat_racks"),cid:"7"},{id:"39",text:s("admin.products_modal_subcategory_outdoor_decor"),cid:"8"},{id:"40",text:s("admin.products_modal_subcategory_gardening_tools_and_planters"),cid:"8"},{id:"41",text:s("admin.products_modal_subcategory_outdoor_leisure"),cid:"8"},{id:"42",text:s("admin.products_modal_subcategory_office_desks_and_chairs"),cid:"9"},{id:"43",text:s("admin.products_modal_subcategory_office_storage_solutions"),cid:"9"},{id:"44",text:s("admin.products_modal_subcategory_office_decor_and_stationery"),cid:"9"},{id:"45",text:s("admin.products_modal_subcategory_childrens_furniture"),cid:"10"},{id:"46",text:s("admin.products_modal_subcategory_childrens_room_decor"),cid:"10"},{id:"47",text:s("admin.products_modal_subcategory_childrens_bedding_and_toy_storage"),cid:"10"}]),x=y(M.typeName),L=y(!1);E(()=>M.typeName,p=>{x.value=p}),E(()=>L.value,()=>{L.value?x.value=`${x.value} ing..`:x.value=M.typeName}),E(()=>a.currentLocale,p=>{x.value=s("admin.products_add_text")}),G(()=>{o.value.id,x.value=M.typeName});const W=K(()=>{if(o.value[a.currentIcon].category){const p=A.value.filter(b=>b.text===o.value[a.currentIcon].category?b.id:null),d=H.value.filter(b=>b.cid===p[0].id);return o.value[a.currentIcon].subcategory=d[0].text,d}return H.value});G(()=>{V.value=new ue(F.value,{backdrop:"static",keyboard:!1})}),ae(()=>{V.value&&V.value.dispose()});const O=y(null),J=y(!1),w=y(""),u=y(!1),$=p=>{var b;u.value=!0;const{files:d}=p.target;if(O.value=d,(b=O.value[0])!=null&&b.name){const g=/\.(jpg|png|jpeg)$/.test(O.value[0].name),I=3*1024*1024;g?(w.value="",O.value[0].size>I&&(w.value="檔案大小限制為 3MB 以下，請重新選擇")):g||(u.value=!1,w.value="限制只能上傳 .jpg、.jpeg  或 .png 格式圖片")}},_=async()=>{try{J.value=!0;const p=new FormData;p.append("file-to-upload",O.value.files[0]);const d=`${i}/v2/api/${N}/admin/upload`,b={"Content-Type":"multipart/form-data"},n=await P.post(d,p,{headers:b});n.data.success&&(o.value[a.currentIcon].imageUrl=n.data.imageUrl,B({position:"top-start",title:`成功 | ${s("admin.message_success")}`,icon:"success",showConfirmButton:!1,timer:1e3}))}catch(p){B({title:`${p.response.data.message} | ${s("admin.message_error")}`,icon:"error",confirmButtonText:`${s("admin.message_confirm_text")}`,confirmButtonColor:"#000000"})}finally{J.value=!1}},T=(p,d)=>{p==="create"?(o.value={title:"",category:"",origin_price:0,price:0,unit:"",description:"",content:"",is_enabled:1,imageUrl:"",imagesUrl:["1","2","3","4","5"],create_date:new Date().getTime(),tw:{...JSON.parse(JSON.stringify(h))},us:{...JSON.parse(JSON.stringify(h))},jp:{...JSON.parse(JSON.stringify(h))},kr:{...JSON.parse(JSON.stringify(h))},th:{...JSON.parse(JSON.stringify(h))}},O.value.value=null,V.value.show()):p==="edit"&&(o.value=d,O.value.value=null,V.value.show())},D=()=>{o.value={title:"",category:"",origin_price:999,price:999,unit:"",description:"",content:"",is_enabled:1,imageUrl:"",imagesUrl:["1","2","3","4","5"],tw:{...JSON.parse(JSON.stringify(h))},us:{...JSON.parse(JSON.stringify(h))},jp:{...JSON.parse(JSON.stringify(h))},kr:{...JSON.parse(JSON.stringify(h))},th:{...JSON.parse(JSON.stringify(h))}},J.value=!1,w.value="",u.value=!1,V.value.hide()};E(()=>o.value.tw,()=>{o.value.category=o.value.tw.category}),ne(()=>{o.value.title=o.value.tw.title,o.value.category=o.value.tw.category,o.value.origin_price=o.value.tw.origin_price,o.value.price=o.value.tw.price,o.value.unit=o.value.tw.unit,o.value.material=o.value.tw.material,o.value.description=o.value.tw.description,o.value.content=o.value.tw.content,o.value.is_enabled=o.value.tw.is_enabled,o.value.imageUrl=o.value.tw.imageUrl,o.value.imagesUrl=o.value.tw.imagesUrl,o.value.imagesUrlDescriptions=o.value.tw.imagesUrlDescriptions,o.value.ratings=o.value.tw.ratings,o.value.sales_num=o.value.tw.sales_num,o.value.isNew=o.value.tw.isNew,o.value.isOnHot=o.value.tw.isOnHot,o.value.isRecommended=o.value.tw.isRecommended,o.value.isOnSale=o.value.tw.isOnSale,o.value.dimensions=o.value.tw.dimensions,o.value.colors=o.value.tw.colors});const q=async()=>{try{L.value=!0;const p=o.value.id?"儲存":"新增";if(!o.value.tw.title){B({title:`失敗 | ${s("admin.message_error")}`,text:"請填寫必填欄後重新後提交",icon:"error",confirmButtonText:`${s("admin.message_confirm_text")}`,confirmButtonColor:"#000000"});return}let d,b;p==="新增"?(d=`${i}/v2/api/${N}/admin/product`,b=await P.post(d,{data:o.value})):p==="儲存"&&(d=`${i}/v2/api/${N}/admin/product/${o.value.id}`,b=await P.put(d,{data:o.value})),b.data.success&&(D(),B({position:"top-start",title:` ${s("admin.message_success")} | ${b.data.message}`,icon:"success",showConfirmButton:!1,timer:1e3}),setTimeout(()=>{R("refetch-products",!0)},1e3))}catch(p){B({title:`${p.response.data.message} | ${s("admin.message_error")}`,icon:"error",confirmButtonText:`${s("admin.message_confirm_text")}`,confirmButtonColor:"#000000"})}finally{L.value=!1}};return z({openModal:T,closeModal:D}),(p,d)=>{var b;return c(),r("div",{class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true",ref_key:"bsModalRef",ref:F},[e("div",pe,[e("div",ge,[e("div",he,[e("h5",ve,[e("span",null,l((b=o.value)!=null&&b.id?`${t(s)("admin.products_edit_text")}：${o.value.id}
                  [${t(s)("admin.products_modal_current_language")}：${t(a).currentLocale}]`:`${t(s)("admin.products_create_title")}
                  [${t(s)("admin.products_modal_current_language")}：${t(a).currentLocale}]`),1)]),e("button",{type:"button",class:"bg-dark text-white fs-4 fw-bolder border-0","data-bs-dismiss":"modal","aria-label":"Close",title:`${t(s)("admin.products_cancel_text")}`,onClick:D}," X ",8,be)]),e("div",fe,[e("ul",ye,[(c(!0),r(S,null,C(t(a).languageList,n=>(c(),r("li",{class:"nav-item",key:n.text},[e("a",{class:X(["nav-link",{active:n.code===t(a).currentLocale}]),"aria-current":"page",href:"#",onClick:le(()=>{t(a).i18nChangeLocale(n.code,n.icon_code)},["prevent"])},[v(l(n.text),1),e("span",{class:X(`fi fi-${n.icon_code}`)},null,2)],10,xe)]))),128))])]),e("div",we,[e("form",null,[e("div",null,[ke,v(l(t(s)("admin.products_modal_illustrate_message")),1)]),$e,e("div",Ie,[e("div",Ue,[e("div",Oe,[e("label",Se,[Ce,v(l(t(s)("admin.products_modal_middle_url_img")),1)]),m(e("input",{id:"imageUrl",type:"text",class:"form-control",placeholder:`${t(s)("admin.products_modal_middle_url_img_placeholder")}`,"onUpdate:modelValue":d[0]||(d[0]=n=>o.value[t(a).currentIcon].imageUrl=n)},null,8,Ne),[[f,o.value[t(a).currentIcon].imageUrl]])]),e("div",Ve,[e("label",Be,l(t(s)("admin.products_modal_middle_file_img")),1),e("input",{class:"form-control",type:"file",name:"file-to-upload",id:"imageUrlFile",ref_key:"fileRef",ref:O,onChange:$},null,544),e("button",{class:X(["input-group-text d-block w-100",{"bg-secondary":J.value,"text-white":J.value}]),type:"button",value:`${t(s)("admin.products_modal_middle_file_img_button")}`,onClick:_,disabled:!u.value||J.value,title:u.value?"上傳檔案":"請先選擇檔案"},l(t(s)("admin.products_modal_middle_file_img_button")),11,Te)]),e("div",Me,[e("label",Le,l(t(s)("admin.products_modal_url_images")),1),(c(!0),r(S,null,C(o.value[t(a).currentIcon].imagesUrl,(n,g)=>m((c(),r("input",{type:"text",class:"form-control w-100",key:g,"onUpdate:modelValue":I=>o.value[t(a).currentIcon].imagesUrl[g]=I,placeholder:`【${g+1}】 ${t(s)("admin.products_modal_url_images_placeholder")}`},null,8,Je)),[[f,o.value[t(a).currentIcon].imagesUrl[g]]])),128))]),e("div",De,[Re,(c(!0),r(S,null,C(o.value[t(a).currentIcon].imagesUrlDescriptions,(n,g)=>m((c(),r("input",{type:"text",class:"form-control w-100",key:g,"onUpdate:modelValue":I=>o.value[t(a).currentIcon].imagesUrlDescriptions[g]=I,placeholder:`【${g+1}】 請輸入圖片描述`},null,8,Pe)),[[f,o.value[t(a).currentIcon].imagesUrlDescriptions[g]]])),128))]),o.value[t(a).currentIcon].imageUrl?(c(),r("div",Ae,[e("h5",He,l(t(s)("admin.products_modal_middle_img_preview")),1),e("img",{class:"img-fluid border border-2",src:o.value[t(a).currentIcon].imageUrl,alt:""},null,8,je)])):U("",!0),(c(!0),r(S,null,C(o.value[t(a).currentIcon].imagesUrl,(n,g)=>(c(),r("div",{key:g},[o.value[t(a).currentIcon].imagesUrl[g]?(c(),r("div",ze,[e("p",Fe,l(t(s)("admin.products_modal_url_images_preview"))+"【"+l(g+1)+"】 ",1),e("img",{class:"img-fluid border border-2",src:o.value[t(a).currentIcon].imagesUrl[g],alt:""},null,8,qe)])):U("",!0)]))),128))]),e("div",Ee,[e("div",Ke,[e("label",We,[Xe,v(l(t(s)("admin.products_modal_title")),1)]),m(e("input",{id:"title",type:"text",class:"form-control",placeholder:t(s)("admin.products_modal_title_placeholder"),"onUpdate:modelValue":d[1]||(d[1]=n=>o.value[t(a).currentIcon].title=n)},null,8,Ze),[[f,o.value[t(a).currentIcon].title]])]),e("div",Ge,[e("div",Qe,[e("label",Ye,[et,v(l(t(s)("admin.products_modal_category")),1)]),m(e("select",{id:"category",class:"form-select form-select-sm","onUpdate:modelValue":d[2]||(d[2]=n=>o.value[t(a).currentIcon].category=n)},[e("option",tt,l(t(s)("admin.products_modal_category_placeholder")),1),(c(!0),r(S,null,C(A.value,n=>(c(),r("option",{value:n.text,key:n.id},l(n.text),9,ot))),128))],512),[[Q,o.value[t(a).currentIcon].category]])]),e("div",st,[e("label",at,[nt,v(l(t(s)("admin.products_modal_subcategory")),1)]),m(e("select",{id:"subcategory",class:"form-select form-select-sm","onUpdate:modelValue":d[3]||(d[3]=n=>o.value[t(a).currentIcon].subcategory=n)},[o.value.subcategory?U("",!0):(c(),r("option",lt,l(t(s)("admin.products_modal_subcategory_placeholder")),1)),(c(!0),r(S,null,C(W.value,n=>(c(),r("option",{key:n.id,value:n.text},l(n.text),9,dt))),128))],512),[[Q,o.value[t(a).currentIcon].subcategory]])]),e("div",it,[e("label",ct,[rt,v(l(t(s)("admin.products_modal_unit")),1)]),m(e("input",{id:"unit",type:"text",class:"form-control",placeholder:t(s)("admin.products_modal_unit_placeholder"),"onUpdate:modelValue":d[4]||(d[4]=n=>o.value[t(a).currentIcon].unit=n)},null,8,_t),[[f,o.value[t(a).currentIcon].unit]])]),e("div",ut,[e("label",mt,[pt,v(l(t(s)("admin.products_modal_stock")),1)]),m(e("input",{id:"stock",type:"number",min:"1",class:"form-control",placeholder:t(s)("admin.products_modal_stock_placeholder"),"onUpdate:modelValue":d[5]||(d[5]=n=>o.value[t(a).currentIcon].stock=n)},null,8,gt),[[f,o.value[t(a).currentIcon].stock,void 0,{number:!0}]])])]),e("div",ht,[e("div",vt,[e("label",bt,[ft,v(l(t(s)("admin.products_modal_origin_price")),1)]),m(e("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:t(s)("admin.products_modal_origin_price_placeholder"),"onUpdate:modelValue":d[6]||(d[6]=n=>o.value[t(a).currentIcon].origin_price=n)},null,8,yt),[[f,o.value[t(a).currentIcon].origin_price,void 0,{number:!0}]])]),e("div",xt,[e("label",wt,[kt,v(l(t(s)("admin.products_modal_price")),1)]),m(e("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:t(s)("admin.products_modal_price_placeholder"),"onUpdate:modelValue":d[7]||(d[7]=n=>o.value[t(a).currentIcon].price=n)},null,8,$t),[[f,o.value[t(a).currentIcon].price,void 0,{number:!0}]])]),e("div",It,[e("label",Ut,[Ot,v(l(t(s)("admin.products_modal_dimensions")),1)]),o.value&&o.value[t(a).currentIcon].dimensions?m((c(),r("input",{key:0,id:"dimensions",type:"number",min:"0",class:"form-control",placeholder:t(s)("admin.products_modal_dimensions_length"),"onUpdate:modelValue":d[8]||(d[8]=n=>o.value[t(a).currentIcon].dimensions.length=n)},null,8,St)),[[f,o.value[t(a).currentIcon].dimensions.length,void 0,{number:!0}]]):U("",!0),o.value&&o.value[t(a).currentIcon].dimensions?m((c(),r("input",{key:1,type:"number",min:"0",class:"form-control",placeholder:t(s)("admin.products_modal_dimensions_width"),"onUpdate:modelValue":d[9]||(d[9]=n=>o.value[t(a).currentIcon].dimensions.width=n)},null,8,Ct)),[[f,o.value[t(a).currentIcon].dimensions.width,void 0,{number:!0}]]):U("",!0),o.value&&o.value[t(a).currentIcon].dimensions?m((c(),r("input",{key:2,type:"number",min:"0",class:"form-control",placeholder:t(s)("admin.products_modal_dimensions_height"),"onUpdate:modelValue":d[10]||(d[10]=n=>o.value[t(a).currentIcon].dimensions.height=n)},null,8,Nt)),[[f,o.value[t(a).currentIcon].dimensions.height,void 0,{number:!0}]]):U("",!0)]),e("div",Vt,[e("label",Bt,[Tt,v(l(t(s)("admin.products_modal_colors"))+" ",1),Mt,Lt,v(l(t(s)("admin.products_modal_colors_subtitle")),1)]),(c(!0),r(S,null,C(o.value[t(a).currentIcon].colors,(n,g)=>(c(),r("div",{class:"input-group",key:g},[m(e("input",{type:"text",class:"form-control d-inline-block w-25",placeholder:t(s)("admin.products_modal_color_name"),"onUpdate:modelValue":I=>n.title=I},null,8,Jt),[[f,n.title]]),m(e("input",{type:"text",class:"form-control d-inline-block w-50",placeholder:t(s)("admin.products_modal_color_code"),"onUpdate:modelValue":I=>n.code=I},null,8,Dt),[[f,n.code]]),e("div",{class:"border border-2 w-25 p2",style:de({backgroundColor:n.code?n.code:""})},null,4)]))),128))])]),e("div",Rt,[e("div",Pt,[e("label",At,[Ht,v(l(t(s)("admin.products_modal_material")),1)]),m(e("input",{id:"material",type:"text",class:"form-control",placeholder:t(s)("admin.products_modal_material_placeholder"),"onUpdate:modelValue":d[11]||(d[11]=n=>o.value[t(a).currentIcon].material=n)},null,8,jt),[[f,o.value[t(a).currentIcon].material]])]),e("div",zt,[e("label",Ft,[qt,v(l(t(s)("admin.products_modal_star")),1)]),(c(!0),r(S,null,C(o.value[t(a).currentIcon].ratings,(n,g)=>(c(),r("div",{key:g,class:"mt-1"},[e("label",{for:g,class:"form-label me-2"},l(g),9,Et),m(e("input",{type:"number",class:"form-control d-inline-block w-50",id:g,"onUpdate:modelValue":I=>n.count=I},null,8,Kt),[[f,n.count,void 0,{number:!0}]])]))),128))])]),e("div",Wt,[e("label",Xt,[Zt,v(l(t(s)("admin.products_modal_description")),1)]),m(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:t(s)("admin.products_modal_description_placeholder"),"onUpdate:modelValue":d[12]||(d[12]=n=>o.value[t(a).currentIcon].description=n)},`\r
                  `,8,Gt),[[f,o.value[t(a).currentIcon].description]])]),e("div",Qt,[e("label",Yt,[eo,v(l(t(s)("admin.products_modal_content")),1)]),m(e("textarea",{id:"content",type:"text",class:"form-control",placeholder:t(s)("admin.products_modal_content_placeholder"),"onUpdate:modelValue":d[13]||(d[13]=n=>o.value[t(a).currentIcon].content=n)},`\r
                  `,8,to),[[f,o.value[t(a).currentIcon].content]])]),e("div",oo,[e("h5",so,[ao,v(l(t(s)("admin.products_modal_tag")),1)]),e("div",no,[e("label",lo,l(t(s)("admin.products_modal_tag_new")),1),m(e("input",{id:"isNew",class:"form-check-input",type:"checkbox","onUpdate:modelValue":d[14]||(d[14]=n=>o.value[t(a).currentIcon].isNew=n),checked:o.value[t(a).currentIcon].isNew},null,8,io),[[j,o.value[t(a).currentIcon].isNew]])]),e("div",co,[e("label",ro,l(t(s)("admin.products_modal_tag_hot")),1),m(e("input",{id:"isOnHot",class:"form-check-input",type:"checkbox","onUpdate:modelValue":d[15]||(d[15]=n=>o.value[t(a).currentIcon].isOnHot=n),checked:o.value[t(a).currentIcon].isOnHot},null,8,_o),[[j,o.value[t(a).currentIcon].isOnHot]])]),e("div",uo,[e("label",mo,l(t(s)("admin.products_modal_tag_recommended")),1),m(e("input",{id:"isRecommended",class:"form-check-input",type:"checkbox","onUpdate:modelValue":d[16]||(d[16]=n=>o.value[t(a).currentIcon].isRecommended=n),checked:o.value[t(a).currentIcon].isRecommended},null,8,po),[[j,o.value[t(a).currentIcon].isRecommended]])]),e("div",go,[e("label",ho,l(t(s)("admin.products_modal_tag_sale")),1),m(e("input",{id:"isOnSale",class:"form-check-input",type:"checkbox","onUpdate:modelValue":d[17]||(d[17]=n=>o.value[t(a).currentIcon].isOnSale=n),checked:o.value[t(a).currentIcon].isOnSale},null,8,vo),[[j,o.value[t(a).currentIcon].isOnSale]])])]),bo,e("div",fo,[e("h5",yo,[xo,v(l(t(s)("admin.products_modal_is_enabled_state")),1)]),e("div",wo,[m(e("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":d[18]||(d[18]=n=>o.value[t(a).currentIcon].is_enabled=n)},null,512),[[j,o.value[t(a).currentIcon].is_enabled]]),e("label",ko,l(t(s)("admin.products_modal_is_enabled_checkbox")),1)])])])]),e("div",$o,[e("button",{type:"button",class:"btn btn-outline-secondary text-dark",onClick:D},l(t(s)("admin.products_cancel_text")),1),e("button",{type:"submit",class:"btn btn-primary text-white px-5",onClick:q,disabled:L.value},[L.value?(c(),r("span",Uo,Co)):U("",!0),v(" "+l(x.value),1)],8,Io)])])])])])],512)}}},Vo={class:"pt-3"},Bo={class:"row"},To={class:"col-6"},Mo={class:"fw-500"},Lo={class:"col-6"},Jo={class:"float-end pe-5"},Do={class:"row border-top border-bottom border-2 my-2 py-3"},Ro={class:"col-5"},Po={value:"",selected:"",disabled:""},Ao=["value"],Ho={class:"table-responsive"},jo={class:"table align-middle"},zo={class:"text-center"},Fo={key:0,class:"text-danger"},qo={key:1},Eo={key:0,class:"text-info"},Ko={key:1,class:"text-danger"},Wo={key:2},Xo=e("span",null,"/",-1),Zo=e("span",{class:"text-success"},"新品",-1),Go=[Xo,Zo],Qo={key:3},Yo=e("span",null,"/",-1),es=e("span",{class:"text-danger"},"已折",-1),ts=[Yo,es],os={key:4},ss={key:5},as=e("span",null,"/",-1),ns=e("span",{class:"text-warning"},"已推薦",-1),ls=[as,ns],ds={style:{minWidth:"158px"}},is={class:"d-flex align-items-center"},cs=["onClick"],rs=["onClick","disabled"],_s={key:0},us=e("span",{class:"spinner-grow spinner-grow-sm me-1","aria-hidden":"true"},null,-1),ms=e("span",{role:"status"},null,-1),ps={key:1},xs={__name:"AdminProductsView",setup(Y){const z=y(null),k=se(),{t:i}=te(),{showAlert:N}=oe(),F=ie(),V=_e(),a=y([]),s=y([]),B=y("新增"),M=y(!1),R=y(""),h=y(""),o=(w,u)=>{w==="create"?B.value=i("admin.products_add_text"):B.value=i("admin.products_keep_text"),z.value.openModal(w,u)},A="https://vue3-course-api.hexschool.io",H="vue-ben0588",x=async(w=1,u="")=>{try{V.toggleLoading();const $=localStorage.getItem("s72241");P.defaults.headers.common.Authorization=$;const _=`${A}/v2/api/${H}/admin/products?page=${w}&category=${u}`,T=await P.get(_);a.value=T.data.products,s.value=T.data.pagination}catch($){N({title:`${$.response.data.message} | ${i("admin.message_error")}`,icon:"error",confirmButtonText:`${i("admin.message_confirm_text")}`,confirmButtonColor:"#000000",allowEscapeKey:!1,allowOutsideClick:!1}).then(_=>{_.isConfirmed&&F.replace("/admin")})}finally{V.toggleLoading()}},L=async w=>{try{R.value=w,M.value=!0,N({title:i("admin.products_delete_title"),text:i("admin.products_delete_confirm_text"),icon:"question",confirmButtonColor:"#111c30",cancelButtonColor:"#b2bec3",confirmButtonText:i("admin.message_confirm_text"),cancelButtonText:i("admin.products_cancel_text"),showCancelButton:!0,showCloseButton:!0,showLoaderOnConfirm:!0,reverseButtons:!0,preConfirm:async()=>{try{const u=`${A}/v2/api/${H}/admin/product/${w}`;return await P.delete(u)}catch(u){return u}},allowOutsideClick:()=>!ce.isLoading()}).then(u=>{var $,_,T,D,q,p,d;(_=($=u==null?void 0:u.value)==null?void 0:$.data)!=null&&_.success?(N({position:"top-start",title:`${u.value.data.message} | ${i("admin.message_success")}`,icon:"success",showConfirmButton:!1,timer:1e3}),setTimeout(()=>{x()},1e3)):((q=(D=(T=u==null?void 0:u.value)==null?void 0:T.response)==null?void 0:D.data)==null?void 0:q.success)===!1&&N({title:`${(d=(p=u==null?void 0:u.value)==null?void 0:p.response)==null?void 0:d.data.message} | ${i("admin.message_error")}`,icon:"error",confirmButtonText:`${i("admin.message_confirm_text")}`,confirmButtonColor:"#000000"}),R.value=""})}catch(u){N({title:`${u.response.data.message} | ${i("admin.message_error")}`,icon:"error",confirmButtonText:`${i("admin.message_confirm_text")}`,confirmButtonColor:"#000000"})}finally{M.value=!1}},W=K(()=>[{id:"1",text:i("admin.products_modal_category_furniture")},{id:"2",text:i("admin.products_modal_category_home_decor")},{id:"3",text:i("admin.products_modal_category_lighting")},{id:"4",text:i("admin.products_modal_category_kitchenware")},{id:"5",text:i("admin.products_modal_category_bathroom_accessories")},{id:"6",text:i("admin.products_modal_category_bedding")},{id:"7",text:i("admin.products_modal_category_storage")},{id:"8",text:i("admin.products_modal_category_outdoor_and_garden")},{id:"9",text:i("admin.products_modal_category_office_supplies")},{id:"10",text:i("admin.products_modal_category_children_furniture")}]),O=()=>{x(s.value.current_page,h.value)},J=()=>{h.value="",x()};return G(()=>{x()}),(w,u)=>{const $=re("font-awesome-icon");return c(),r("div",Vo,[e("div",Bo,[e("span",To,[e("h3",Mo,l(t(i)("admin.products_title")),1)]),e("span",Lo,[e("div",Jo,[e("button",{type:"button",class:"btn btn-success px-4",onClick:u[0]||(u[0]=_=>o("create"))},l(t(i)("admin.products_create_text")),1)])])]),e("span",Do,[e("div",Ro,[e("button",{type:"button",class:"btn border border-1 d-inline reset-btn me-2",style:{marginTop:"-0.10rem",marginBottom:"0.10rem"},title:"重置選擇",onClick:J},[Z($,{icon:["fas","rotate"],class:""})]),m(e("select",{class:"form-select d-inline w-50","aria-label":"Default select example","onUpdate:modelValue":u[1]||(u[1]=_=>h.value=_),onChange:O},[e("option",Po,l(t(i)("admin.products_modal_category_placeholder")),1),(c(!0),r(S,null,C(W.value,_=>(c(),r("option",{value:_.text,key:_.id},l(_.text),9,Ao))),128))],544),[[Q,h.value]])])]),e("div",Ho,[e("table",jo,[e("thead",null,[e("tr",null,[e("td",null,l(t(i)("admin.products_id")),1),e("td",null,l(t(i)("admin.products_name")),1),e("td",null,l(t(i)("admin.products_category")),1),e("td",null,l(t(i)("admin.products_price"))+"(NT)",1),e("td",null,l(t(i)("admin.products_state"))+"/標籤",1),e("td",zo,l(t(i)("admin.products_operate")),1)])]),e("tbody",null,[(c(!0),r(S,null,C(a.value,_=>(c(),r("tr",{key:_.id},[e("td",null,l(_.id),1),e("td",null,l(_[t(k).currentIcon].title),1),e("td",null,l(_[t(k).currentIcon].category),1),e("td",null,[_[t(k).currentIcon].isOnSale?(c(),r("span",Fo,l(t(ee)(_[t(k).currentIcon].price)),1)):(c(),r("span",qo,l(t(ee)(_[t(k).currentIcon].origin_price)),1))]),e("td",null,[_[t(k).currentIcon].is_enabled?(c(),r("span",Eo,l(t(i)("admin.products_on_enabled")),1)):(c(),r("span",Ko,l(t(i)("admin.products_off_enabled")),1)),_[t(k).currentIcon].isNew?(c(),r("span",Wo,Go)):U("",!0),_[t(k).currentIcon].isOnSale?(c(),r("span",Qo,ts)):U("",!0),_[t(k).currentIcon].isOnSale?U("",!0):(c(),r("span",os,"/原價")),_[t(k).currentIcon].isRecommended?(c(),r("span",ss,ls)):U("",!0)]),e("td",ds,[e("div",is,[e("button",{type:"button",class:"btn btn-outline-dark me-1",onClick:T=>o("edit",_)},l(t(i)("admin.products_edit_text")),9,cs),e("button",{type:"button",class:"btn btn-outline-danger",onClick:T=>L(_.id),disabled:R.value===_.id},[R.value===_.id?(c(),r("span",_s,[us,ms,e("span",null,l(t(i)("admin.products_delete_text")),1)])):(c(),r("span",ps,l(t(i)("admin.products_delete_text")),1))],8,rs)])])]))),128))])])]),Z(me,{pagination:s.value,"onUpdated:page":x},null,8,["pagination"]),Z(No,{ref_key:"adminProductsModal",ref:z,typeName:B.value,onRefetchProducts:x},null,8,["typeName"])])}}};export{xs as default};
