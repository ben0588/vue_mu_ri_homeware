import{r as d,E as O,a9 as N,aa as T,p as x,c as m,b as e,t as _,u as r,l as D,n as f,w as C,d as B,F as y,f as E,e as k,ab as L,z as F,o as p,A as R,a as z}from"./index-rXVu0dOo.js";import{D as K}from"./bootstrap.esm-FzNOyMo5.js";import{V as j}from"./index-denRwXsk.js";import{u as q}from"./i18nStores-mPVvzW51.js";import{u as G}from"./adminStores-ClRMAcIb.js";const H={class:"navbar bg-dark"},J={class:"container-fluid bg-dark py-1"},P={class:"navbar-brand text-white ps-2"},Q={class:"list-unstyled d-flex justify-content-center align-items-center m-0"},U={key:0,class:"me-2"},W={class:"dropdown me-4"},X=["aria-expanded"],Y=["onClick"],se={__name:"AdminView",setup(Z){const l=G(),{showAlert:c}=R();d(!1);const $=O(),w=N(),i=d(!1),h=q(),{i18nChangeLocale:I}=h,{t:a}=T(),n=d(!1),v=d(null);function S(){n.value=!n.value}const V=(s,t)=>{I(s,t),n.value=!1},A=async()=>{try{const s="https://vue3-course-api.hexschool.io/v2/logout";c({title:"管理者登出?",text:"確定登出請按下確認按鈕",icon:"question",confirmButtonColor:"#111c30",cancelButtonColor:"#b2bec3",confirmButtonText:"確認",cancelButtonText:"取消",showCancelButton:!0,showCloseButton:!0,reverseButtons:!0,preConfirm:async()=>{try{return i.value=!0,await F.post(s)}catch(t){return c({title:`${t.response.data.message} | ${a("admin.message_error")}`,text:"登出失敗，請關閉頁面重新嘗試登出",icon:"error",confirmButtonText:`${a("admin.message_confirm_text")}`,confirmButtonColor:"#000000",allowEscapeKey:!1,allowOutsideClick:!1}),localStorage.setItem("s72241",""),i.value=!1,!1}},allowOutsideClick:()=>!L.isLoading()}).then(t=>{var u,o,g,b;i.value=!1,(o=(u=t==null?void 0:t.value)==null?void 0:u.data)!=null&&o.success&&(localStorage.setItem("s72241",""),c({icon:"success",title:"成功",text:`${(b=(g=t==null?void 0:t.value)==null?void 0:g.data)==null?void 0:b.message} | 即將返回登入頁`,showConfirmButton:!1,timer:1e3}).then(M=>{M.dismiss===L.DismissReason.timer&&(l.isLogin=!1,w.push({path:"/admin"}))}))})}catch(s){c({title:`${s.response.data.message} | ${a("admin.message_error")}`,text:"登出失敗，請關閉頁面重新開啟",icon:"error",confirmButtonText:`${a("admin.message_confirm_text")}`,confirmButtonColor:"#000000",allowEscapeKey:!1,allowOutsideClick:!1}),l.isLogin=!1,w.push({path:"/admin"})}finally{i.value=!1}};return x(()=>{K.getOrCreateInstance(v.value)}),x(()=>{$.path.includes("dashboard")&&(l.isLogin=!0)}),(s,t)=>{const u=z("router-view");return p(),m(y,null,[e("header",null,[e("nav",H,[e("div",J,[e("a",P,_(r(a)("admin.dashboardName")),1),e("ul",Q,[r(l).isLogin?(p(),m("li",U,[e("button",{type:"button",class:"btn btn-light bg-dark text-white",onClick:A}," 管理者登出 ")])):D("",!0),e("li",null,[e("div",W,[e("button",{class:f(["btn btn-secondary dropdown-toggle bg-dark text-white",n.value?"show":""]),type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":n.value,onClick:C(S,["stop"]),ref_key:"dropdownMenuButton",ref:v},[B(_(r(a)("admin.select_language_text"))+" | ",1),e("span",{class:f(`fi fi-${r(h).currentIcon}`)},null,2)],10,X),e("ul",{class:f(["dropdown-menu",n.value?"show":""]),"aria-labelledby":"dropdownMenuButton"},[(p(!0),m(y,null,E(r(h).languageList,o=>(p(),m("li",{key:o.code},[e("a",{class:"dropdown-item",onClick:C(g=>V(o.code,o.icon_code),["prevent"])},[e("span",{class:f(`fi fi-${o.icon_code}`)},null,2),B(_(o.text),1)],8,Y)]))),128))],2)])])])])])]),k(r(j),{active:i.value,"can-cancel":!1,color:"#d63031"},null,8,["active"]),k(u)],64)}}};export{se as default};
